---
# tasks file for teamspeak

- name: "Load OS specific variables"
  include_vars: "{{ item }}"
  with_first_found: 
    - files: 
        - "{{ ansible_distribution|lower }}.yml"
        - "{{ ansible_os_family|lower }}.yml"
        - "{{ ansible_system|lower }}.yml"
        - main.yml
      paths: 
        - ../vars

# Installation of TeamSpeak 3 Server 
- include: install.yml

# Configuration of TeamSpeak 3 Server (if requested)
- include: config.yml
  when: teamspeak_ini_enabled

# Perform the running of handlers now
# So we can do "Reload systemd" (and possibly queued clean-up) 
# before we start using the new/changed .service file.
- meta: flush_handlers
# Make sure TeamSpeak 3 Server is started and enabled
- name: Enable and start TeamSpeak 3 Server
  service:
    name: teamspeak3-server
    state: started
    enabled: yes
